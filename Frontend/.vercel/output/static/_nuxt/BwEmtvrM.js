import{b as q,d as ce,i as z,e as se,f as ie}from"./Cv_xL7jc.js";import{q as K,y as B,r as A,g as oe,S as U,a3 as I,R as _,a4 as W,a5 as fe,a6 as de,j as le,o as pe,a7 as Ee,a8 as D,a9 as p,a1 as ve,aa as me,m as Te,ab as _e}from"./logkf7nQ.js";import{_ as re,w as be}from"./BN3SMaRa.js";import{b as Se,d as Le}from"./CN6nfdWM.js";const P="focus-trap.focus-after-trapped",k="focus-trap.focus-after-released",ye="focus-trap.focusout-prevented",X={cancelable:!0,bubbles:!1},Ae={cancelable:!0,bubbles:!1},h="focusAfterTrapped",J="focusAfterReleased",Ne=Symbol("elFocusTrap"),H=A(),N=A(0),M=A(0);let b=0;const ue=e=>{const s=[],o=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:t=>{const r=t.tagName==="INPUT"&&t.type==="hidden";return t.disabled||t.hidden||r?NodeFilter.FILTER_SKIP:t.tabIndex>=0||t===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;o.nextNode();)s.push(o.currentNode);return s},Q=(e,s)=>{for(const o of e)if(!Oe(o,s))return o},Oe=(e,s)=>{if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(s&&e===s)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1},Ce=e=>{const s=ue(e),o=Q(s,e),t=Q(s.reverse(),e);return[o,t]},Fe=e=>e instanceof HTMLInputElement&&"select"in e,l=(e,s)=>{if(e&&e.focus){const o=document.activeElement;let t=!1;q(e)&&!ce(e)&&!e.getAttribute("tabindex")&&(e.setAttribute("tabindex","-1"),t=!0),e.focus({preventScroll:!0}),M.value=window.performance.now(),e!==o&&Fe(e)&&s&&e.select(),q(e)&&t&&e.removeAttribute("tabindex")}};function Z(e,s){const o=[...e],t=e.indexOf(s);return t!==-1&&o.splice(t,1),o}const Re=()=>{let e=[];return{push:t=>{const r=e[0];r&&t!==r&&r.pause(),e=Z(e,t),e.unshift(t)},remove:t=>{var r,f;e=Z(e,t),(f=(r=e[0])==null?void 0:r.resume)==null||f.call(r)}}},we=(e,s=!1)=>{const o=document.activeElement;for(const t of e)if(l(t,s),document.activeElement!==o)return},ee=Re(),Ie=()=>N.value>M.value,S=()=>{H.value="pointer",N.value=window.performance.now()},te=()=>{H.value="keyboard",N.value=window.performance.now()},De=()=>(K(()=>{b===0&&(document.addEventListener("mousedown",S),document.addEventListener("touchstart",S),document.addEventListener("keydown",te)),b++}),B(()=>{b--,b<=0&&(document.removeEventListener("mousedown",S),document.removeEventListener("touchstart",S),document.removeEventListener("keydown",te))}),{focusReason:H,lastUserFocusTimestamp:N,lastAutomatedFocusTimestamp:M}),L=e=>new CustomEvent(ye,{...Ae,detail:e});let v=[];const ne=e=>{e.code===se.esc&&v.forEach(s=>s(e))},Pe=e=>{K(()=>{v.length===0&&document.addEventListener("keydown",ne),z&&v.push(e)}),B(()=>{v=v.filter(s=>s!==e),v.length===0&&z&&document.removeEventListener("keydown",ne)})},ke=oe({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[h,J,"focusin","focusout","focusout-prevented","release-requested"],setup(e,{emit:s}){const o=A();let t,r;const{focusReason:f}=De();Pe(n=>{e.trapped&&!E.paused&&s("release-requested",n)});const E={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},m=n=>{if(!e.loop&&!e.trapped||E.paused)return;const{code:u,altKey:a,ctrlKey:c,metaKey:i,currentTarget:x,shiftKey:G}=n,{loop:g}=e,ae=u===se.tab&&!a&&!c&&!i,T=document.activeElement;if(ae&&T){const F=x,[R,w]=Ce(F);if(R&&w){if(!G&&T===w){const d=L({focusReason:f.value});s("focusout-prevented",d),d.defaultPrevented||(n.preventDefault(),g&&l(R,!0))}else if(G&&[R,F].includes(T)){const d=L({focusReason:f.value});s("focusout-prevented",d),d.defaultPrevented||(n.preventDefault(),g&&l(w,!0))}}else if(T===F){const d=L({focusReason:f.value});s("focusout-prevented",d),d.defaultPrevented||n.preventDefault()}}};de(Ne,{focusTrapRef:o,onKeydown:m}),I(()=>e.focusTrapEl,n=>{n&&(o.value=n)},{immediate:!0}),I([o],([n],[u])=>{n&&(n.addEventListener("keydown",m),n.addEventListener("focusin",O),n.addEventListener("focusout",C)),u&&(u.removeEventListener("keydown",m),u.removeEventListener("focusin",O),u.removeEventListener("focusout",C))});const Y=n=>{s(h,n)},V=n=>s(J,n),O=n=>{const u=_(o);if(!u)return;const a=n.target,c=n.relatedTarget,i=a&&u.contains(a);e.trapped||c&&u.contains(c)||(t=c),i&&s("focusin",n),!E.paused&&e.trapped&&(i?r=a:l(r,!0))},C=n=>{const u=_(o);if(!(E.paused||!u))if(e.trapped){const a=n.relatedTarget;!ie(a)&&!u.contains(a)&&setTimeout(()=>{if(!E.paused&&e.trapped){const c=L({focusReason:f.value});s("focusout-prevented",c),c.defaultPrevented||l(r,!0)}},0)}else{const a=n.target;a&&u.contains(a)||s("focusout",n)}};async function $(){await W();const n=_(o);if(n){ee.push(E);const u=n.contains(document.activeElement)?t:document.activeElement;if(t=u,!n.contains(u)){const c=new Event(P,X);n.addEventListener(P,Y),n.dispatchEvent(c),c.defaultPrevented||W(()=>{let i=e.focusStartEl;fe(i)||(l(i),document.activeElement!==i&&(i="first")),i==="first"&&we(ue(n),!0),(document.activeElement===u||i==="container")&&l(n)})}}}function j(){const n=_(o);if(n){n.removeEventListener(P,Y);const u=new CustomEvent(k,{...X,detail:{focusReason:f.value}});n.addEventListener(k,V),n.dispatchEvent(u),!u.defaultPrevented&&(f.value=="keyboard"||!Ie()||n.contains(document.activeElement))&&l(t??document.body),n.removeEventListener(k,V),ee.remove(E)}}return K(()=>{e.trapped&&$(),I(()=>e.trapped,n=>{n?$():j()})}),B(()=>{e.trapped&&j(),o.value&&(o.value.removeEventListener("keydown",m),o.value.removeEventListener("focusin",O),o.value.removeEventListener("focusout",C),o.value=void 0)}),{onKeydown:m}}});function Ue(e,s,o,t,r,f){return U(e.$slots,"default",{handleKeydown:e.onKeydown})}var qe=re(ke,[["render",Ue],["__file","focus-trap.vue"]]);const Ke=Se({to:{type:Le([String,Object]),required:!0},disabled:Boolean}),Be=oe({__name:"teleport",props:Ke,setup(e){return(s,o)=>s.disabled?U(s.$slots,"default",{key:0}):(pe(),le(Ee,{key:1,to:s.to},[U(s.$slots,"default")],8,["to"]))}});var He=re(Be,[["__file","teleport.vue"]]);const ze=be(He);var Me=(e=>(e[e.TEXT=1]="TEXT",e[e.CLASS=2]="CLASS",e[e.STYLE=4]="STYLE",e[e.PROPS=8]="PROPS",e[e.FULL_PROPS=16]="FULL_PROPS",e[e.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",e[e.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",e[e.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",e[e.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",e[e.NEED_PATCH=512]="NEED_PATCH",e[e.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",e[e.HOISTED=-1]="HOISTED",e[e.BAIL=-2]="BAIL",e))(Me||{});function Ye(e){return p(e)&&e.type===ve}function Ve(e){return p(e)&&e.type===me}function We(e){return p(e)&&!Ye(e)&&!Ve(e)}const Xe=e=>{if(!p(e))return{};const s=e.props||{},o=(p(e.type)?e.type.props:void 0)||{},t={};return Object.keys(o).forEach(r=>{Te(o[r],"default")&&(t[r]=o[r].default)}),Object.keys(s).forEach(r=>{t[_e(r)]=s[r]}),t},y=e=>{const s=D(e)?e:[e],o=[];return s.forEach(t=>{var r;D(t)?o.push(...y(t)):p(t)&&((r=t.component)!=null&&r.subTree)?o.push(t,...y(t.component.subTree)):p(t)&&D(t.children)?o.push(...y(t.children)):p(t)&&t.shapeFlag===2?o.push(...y(t.type())):o.push(t)}),o};export{qe as E,Ne as F,Me as P,ze as a,l as b,We as c,y as f,Xe as g,Ye as i,Ke as t};
